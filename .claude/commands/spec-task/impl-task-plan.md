---
description: Generate detailed implementation plan for a specific task
allowed-tools:
  Bash, Glob, Grep, LS, Read, Write, Edit, MultiEdit, WebSearch, WebFetch, Task,
  Agent
argument-hint: <feature-name> <task-number>
---

# ä»»åŠ¡çº§å®æ–½è®¡åˆ’

ä¸ºç‰¹å®šä»»åŠ¡ç”Ÿæˆè¯¦ç»†çš„å®æ–½è®¡åˆ’ï¼š**$ARGUMENTS**

## è¯´æ˜

æ­¤å‘½ä»¤ä¸ºå•ä¸ªä»»åŠ¡ç”Ÿæˆè¯¦ç»†çš„å®æ–½è®¡åˆ’ï¼ŒåŒ…æ‹¬ï¼š

- å…·ä½“çš„å®æ–½æ­¥éª¤åˆ†è§£
- TDDæµ‹è¯•ç­–ç•¥
- éœ€è¦è°ƒç”¨çš„APIå’Œæ–¹æ³•
- æ½œåœ¨çš„æŠ€æœ¯éš¾ç‚¹
- éªŒæ”¶æ ‡å‡†

## å‚æ•°è§£æ

- **feature-name**: åŠŸèƒ½åç§°
- **task-number**: ä»»åŠ¡ç¼–å·ï¼ˆå¦‚ 1.1, 2.3ï¼‰

## å…ˆå†³æ¡ä»¶éªŒè¯

### å¿…éœ€æ–‡ä»¶æ£€æŸ¥

åŠŸèƒ½åç§°ï¼š!`echo "$ARGUMENTS" | awk '{print $1}' | head -1`
ä»»åŠ¡ç¼–å·ï¼š!`echo "$ARGUMENTS" | awk '{print $2}' | head -1`

- ä»»åŠ¡æ–‡æ¡£ï¼š!`ls -la .tasks/$FEATURE/tasks.md 2>/dev/null || echo "Tasks not found - run spec-task:tasks first"`
- ä½å±‚è®¾è®¡ï¼š!`ls -la .tasks/$FEATURE/lld/ 2>/dev/null || echo "LLD directory not found"`
- è§„èŒƒå…ƒæ•°æ®ï¼š!`cat .tasks/$FEATURE/spec.json 2>/dev/null | grep "tasks_approved" || echo "Tasks not approved"`

## ä»»åŠ¡ï¼šç”Ÿæˆå•ä»»åŠ¡å®æ–½è®¡åˆ’

### 1. åŠ è½½ä¸Šä¸‹æ–‡

ä»ä»¥ä¸‹æ–‡ä»¶åŠ è½½ç›¸å…³ä¿¡æ¯ï¼š

- `.tasks/{feature-name}/requirements.md` - ç›¸å…³éœ€æ±‚
- `.tasks/$ARGUMENTS/design-hld.md` - é«˜å±‚è®¾è®¡
- `.tasks/{feature-name}/lld/` - è¯¦ç»†è®¾è®¡æ–‡æ¡£é›†
- `.tasks/{feature-name}/tasks.md` - æå–ç‰¹å®šä»»åŠ¡æè¿°
- `.tasks/$ARGUMENTS/adr/` - adr å†³ç­–

### 2. ä»»åŠ¡åˆ†æ

#### 2.1 æå–ä»»åŠ¡ä¿¡æ¯

ä» tasks.md ä¸­æ‰¾åˆ°æŒ‡å®šç¼–å·çš„ä»»åŠ¡ï¼š

- ä»»åŠ¡æè¿°
- å…³è”çš„éœ€æ±‚ç¼–å·
- ä¾èµ–çš„å‰ç½®ä»»åŠ¡

#### 2.2 æŠ€æœ¯ä¾èµ–åˆ†æ

è¯†åˆ«è¯¥ä»»åŠ¡éœ€è¦çš„ï¼š

- å…·ä½“çš„åº“å’Œæ¡†æ¶
- APIæ¥å£å’Œæ–¹æ³•
- æ•°æ®æ¨¡å‹
- é…ç½®è¦æ±‚

### 3. ç”Ÿæˆä»»åŠ¡è®¡åˆ’æ–‡æ¡£

åˆ›å»º `.tasks/{feature-name}/task-plans/{task-number}.md`ï¼š

````markdown
# ä»»åŠ¡ {task-number} å®æ–½è®¡åˆ’

ç”Ÿæˆæ—¶é—´ï¼š{timestamp} ä»»åŠ¡æè¿°ï¼š{task-description} å…³è”éœ€æ±‚ï¼š{requirements} é¢„è®¡å·¥æ—¶ï¼š{estimated-hours}

## æ‰§è¡Œæ¦‚è¦

### ç›®æ ‡

{æ˜ç¡®çš„ä»»åŠ¡ç›®æ ‡}

### èŒƒå›´

- **åŒ…å«**ï¼š{å…·ä½“è¦å®ç°çš„åŠŸèƒ½}
- **ä¸åŒ…å«**ï¼š{æ˜ç¡®ä¸åœ¨æ­¤ä»»åŠ¡èŒƒå›´å†…çš„å†…å®¹}

### å‰ç½®æ¡ä»¶

- {éœ€è¦å®Œæˆçš„å‰ç½®ä»»åŠ¡}
- {éœ€è¦çš„ç¯å¢ƒæˆ–é…ç½®}

## æŠ€æœ¯å‡†å¤‡

### éœ€è¦çš„API/åº“

| åº“/æ¨¡å— | æ–¹æ³•/ç±»  | ç”¨é€”    | æ–‡æ¡£é“¾æ¥ |
| ------- | -------- | ------- | -------- |
| {lib}   | {method} | {usage} | {docs}   |

### ä»£ç ä½ç½®

- **éœ€è¦åˆ›å»ºçš„æ–‡ä»¶**ï¼š
  - `{file-path}` - {purpose}
- **éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
  - `{file-path}` - {changes}

## TDDå®æ–½æ­¥éª¤

### æ­¥éª¤1ï¼š{æ­¥éª¤åç§°}

**æµ‹è¯•å…ˆè¡Œï¼ˆREDï¼‰**ï¼š

```{language}
// æµ‹è¯•æ–‡ä»¶ï¼š{test-file}
test('{test-description}', () => {
  // å‡†å¤‡
  {setup-code}

  // æ‰§è¡Œ
  {action-code}

  // æ–­è¨€
  {assertion-code}
})
```
````

**æœ€å°å®ç°ï¼ˆGREENï¼‰**ï¼š

```{language}
// å®ç°æ–‡ä»¶ï¼š{impl-file}
{minimal-implementation}
```

**é‡æ„ä¼˜åŒ–ï¼ˆREFACTORï¼‰**ï¼š

- {refactor-point-1}
- {refactor-point-2}

### æ­¥éª¤2ï¼š{æ­¥éª¤åç§°}

[ç»§ç»­å…¶ä»–æ­¥éª¤...]

## è¾¹ç•Œæƒ…å†µå¤„ç†

### é”™è¯¯åœºæ™¯

1. **{error-scenario}**
   - è§¦å‘æ¡ä»¶ï¼š{condition}
   - å¤„ç†æ–¹å¼ï¼š{handling}
   - æµ‹è¯•ç”¨ä¾‹ï¼š{test-case}

### æ€§èƒ½è€ƒè™‘

- {performance-consideration}

## éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] {functional-criterion-1}
- [ ] {functional-criterion-2}

### æŠ€æœ¯éªŒæ”¶

- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç è¦†ç›–ç‡ > 80%
- [ ] æ—  linting é”™è¯¯
- [ ] ä»£ç å¤æ‚åº¦ç¬¦åˆæ ‡å‡†

### é›†æˆéªŒæ”¶

- [ ] ä¸å‰ç½®ä»»åŠ¡è¾“å‡ºæ­£ç¡®å¯¹æ¥
- [ ] ä¸ºåç»­ä»»åŠ¡æä¾›å¿…è¦æ¥å£

## é£é™©ä¸ç¼“è§£

| é£é™©   | æ¦‚ç‡          | å½±å“     | ç¼“è§£æªæ–½     |
| ------ | ------------- | -------- | ------------ |
| {risk} | {probability} | {impact} | {mitigation} |

## å®æ–½æ£€æŸ¥æ¸…å•

### å¼€å§‹å‰

- [ ] ç¡®è®¤æ‰€æœ‰å‰ç½®ä»»åŠ¡å®Œæˆ
- [ ] ç¡®è®¤å¼€å‘ç¯å¢ƒé…ç½®æ­£ç¡®
- [ ] ç†è§£ä»»åŠ¡éœ€æ±‚å’Œè®¾è®¡

### å®æ–½ä¸­

- [ ] éµå¾ªTDDæµç¨‹
- [ ] æ¯ä¸ªæ­¥éª¤åè¿è¡Œæµ‹è¯•
- [ ] åŠæ—¶æäº¤ä»£ç 

### å®Œæˆå

- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
- [ ] ä»£ç å®¡æŸ¥ï¼ˆcode-review-expertï¼‰
- [ ] ä»£ç ç®€åŒ–ï¼ˆcode-simplifierï¼‰
- [ ] æ›´æ–°ä»»åŠ¡çŠ¶æ€

## æ—¶é—´ä¼°ç®—

| é˜¶æ®µ      | é¢„è®¡æ—¶é—´ |
| --------- | -------- |
| æŠ€æœ¯å‡†å¤‡  | 15åˆ†é’Ÿ   |
| æ­¥éª¤1å®æ–½ | {time}   |
| æ­¥éª¤2å®æ–½ | {time}   |
| æµ‹è¯•å®Œå–„  | 30åˆ†é’Ÿ   |
| ä»£ç ä¼˜åŒ–  | 20åˆ†é’Ÿ   |
| **æ€»è®¡**  | {total}  |

## å®¡æ‰¹çŠ¶æ€

- [ ] è®¡åˆ’å·²å®¡é˜…
- [ ] æŠ€æœ¯æ–¹æ¡ˆå·²ç¡®è®¤
- [ ] å‡†å¤‡å¼€å§‹å®æ–½

---

_æ­¤æ–‡æ¡£ç”± spec-task:impl-task-plan ç”Ÿæˆï¼Œä½œä¸ºå•ä»»åŠ¡å®æ–½çš„è¯¦ç»†æŒ‡å¯¼_

````

### 4. æ›´æ–°å…ƒæ•°æ®

åœ¨ spec.json ä¸­æ·»åŠ ä»»åŠ¡è®¡åˆ’çŠ¶æ€ï¼š

```json
{
  "task_plans": {
    "{task-number}": {
      "planned": true,
      "approved": false,
      "planned_at": "{timestamp}"
    }
  }
}
````

### 5. è¾“å‡ºæ‘˜è¦

```
âœ… ä»»åŠ¡è®¡åˆ’å·²ç”Ÿæˆ

ğŸ“Š è®¡åˆ’æ¦‚è¦ï¼š
- ä»»åŠ¡ç¼–å·ï¼š{task-number}
- å®æ–½æ­¥éª¤ï¼š{n} ä¸ª
- é¢„è®¡å·¥æ—¶ï¼š{hours} å°æ—¶
- æµ‹è¯•ç”¨ä¾‹ï¼š{m} ä¸ª
- é£é™©ç‚¹ï¼š{r} ä¸ª

ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶ï¼š
- task-plans/{task-number}.md

ğŸ¯ ä¸‹ä¸€æ­¥ï¼š
1. å®¡æŸ¥è®¡åˆ’ï¼šæŸ¥çœ‹ç”Ÿæˆçš„è¯¦ç»†è®¡åˆ’
2. å¦‚éœ€è°ƒæ•´ï¼šç¼–è¾‘è®¡åˆ’æ–‡ä»¶
3. æ‰¹å‡†æ‰§è¡Œï¼š/spec-task:impl {feature} {task-number} --use-plan

ğŸ’¡ æç¤ºï¼š
- è®¡åˆ’é€šè¿‡å®¡æ ¸åï¼Œimpl å‘½ä»¤ä¼šè‡ªåŠ¨ä½¿ç”¨æ­¤è®¡åˆ’
- å¯ä»¥å¹¶è¡Œè§„åˆ’å¤šä¸ªä»»åŠ¡
- å¤æ‚ä»»åŠ¡å»ºè®®å…ˆåšè®¡åˆ’å†å®æ–½
```

## ä¸ impl å‘½ä»¤çš„é›†æˆ

ä¿®æ”¹ impl.mdï¼Œå¢åŠ å¯¹ä»»åŠ¡è®¡åˆ’çš„æ”¯æŒï¼š

```bash
# å¦‚æœå­˜åœ¨å·²æ‰¹å‡†çš„ä»»åŠ¡è®¡åˆ’
if [ -f ".tasks/{feature}/task-plans/{task-number}.md" ]; then
  # åŠ è½½ä»»åŠ¡è®¡åˆ’ä½œä¸ºå®æ–½æŒ‡å¯¼
  # æŒ‰è®¡åˆ’çš„æ­¥éª¤æ‰§è¡Œ
fi
```

## ä½¿ç”¨æµç¨‹

```mermaid
graph LR
    A[spec-task:tasks] --> B[é€‰æ‹©ä»»åŠ¡]
    B --> C{ä»»åŠ¡å¤æ‚åº¦}
    C -->|ç®€å•| D[ç›´æ¥ impl]
    C -->|å¤æ‚| E[impl-task-plan]
    E --> F[å®¡æŸ¥è®¡åˆ’]
    F --> G{æ‰¹å‡†?}
    G -->|æ˜¯| H[impl --use-plan]
    G -->|å¦| I[ä¿®æ”¹è®¡åˆ’]
    I --> F
    D --> J[ä»»åŠ¡å®Œæˆ]
    H --> J
```

## æœ€ä½³å®è·µ

1. **ç®€å•ä»»åŠ¡**ï¼ˆ< 1å°æ—¶ï¼‰ï¼šç›´æ¥ä½¿ç”¨ impl
2. **ä¸­ç­‰ä»»åŠ¡**ï¼ˆ1-3å°æ—¶ï¼‰ï¼šå¯é€‰ä½¿ç”¨ impl-task-plan
3. **å¤æ‚ä»»åŠ¡**ï¼ˆ> 3å°æ—¶ï¼‰ï¼šå¼ºçƒˆå»ºè®®å…ˆ impl-task-plan
4. **é«˜é£é™©ä»»åŠ¡**ï¼šå¿…é¡»å…ˆ impl-task-plan

## ä¼˜åŠ¿

- **ç²¾ç¡®æ§åˆ¶**ï¼šæ¯ä¸ªä»»åŠ¡éƒ½æœ‰è¯¦ç»†çš„å®æ–½æ­¥éª¤
- **é™ä½é£é™©**ï¼šå®æ–½å‰å¯ä»¥å®¡æŸ¥å’Œè°ƒæ•´æ–¹æ¡ˆ
- **æé«˜æ•ˆç‡**ï¼šé¿å…å®æ–½æ—¶çš„è¯•é”™å’Œè¿”å·¥
- **çŸ¥è¯†æ²‰æ·€**ï¼šä»»åŠ¡è®¡åˆ’å¯ä½œä¸ºå›¢é˜ŸçŸ¥è¯†åº“
- **çµæ´»ä½¿ç”¨**ï¼šå¯é€‰æ‹©æ€§åœ°å¯¹å¤æ‚ä»»åŠ¡ä½¿ç”¨
