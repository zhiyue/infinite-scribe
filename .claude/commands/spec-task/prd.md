---
description:
  Generate Product Requirements Document (PRD) with user stories and business
  value
allowed-tools:
  Bash, Glob, Grep, LS, Read, Write, Edit, MultiEdit, Update, WebSearch,
  WebFetch, TodoWrite
argument-hint: <feature-name>
---

# 产品需求文档（PRD）生成

为功能生成产品需求文档：**$ARGUMENTS**

## 上下文验证

### 现有规范上下文

- 当前规范目录：!`ls -la .tasks/$ARGUMENTS/`
- 当前 PRD：@.tasks/$ARGUMENTS/prd.md
- 规范元数据：@.tasks/$ARGUMENTS/spec.json

## 任务：生成产品需求文档（PRD）

基于功能想法生成一份面向**业务与用户**的产品需求文档，重点讲清"要做什么"和"为什么做"。与用户迭代优化，直到需求完整准确

### PRD 生成指南

1. **业务价值优先**：从商业目标和用户价值出发，不涉及技术实现细节
2. **用户故事为核心**：使用 User Story 或 Job Story 句式描述功能
3. **高层验收标准**：业务可读的验收标准，详细可测标准留给 requirements.md
4. **保持可追踪性**：为每个 Story 分配唯一 ID，便于后续文档引用

### 1. 用户故事格式

**User Story 格式：**

```
作为 <角色>，我想要 <能力>，以便 <收益>
```

**Job Story 格式：**

```
当 <情境>，我想要 <动机>，从而 <预期结果>
```

### 2. PRD 文档结构

根据 spec.json 中指定的语言生成 prd.md（检查 `@.tasks/$ARGUMENTS/spec.json`
中的 "language" 字段）：

```markdown
# 产品需求文档（PRD）

## 1. 背景与机会

### 问题陈述

[描述当前存在的问题或未满足的需求]

### 市场机会

[说明解决这个问题的商业价值]

## 2. 目标与非目标

### 业务目标（Business Goals）

- [目标1：具体、可衡量的业务目标]
- [目标2：与公司战略对齐的目标]
- [目标3：预期的业务成果]

### 非目标（Non-Goals）

- [明确不在本期范围内的功能]
- [刻意排除的功能或场景]

## 3. 用户画像与关键场景

### 目标用户

- **主要用户**：[描述核心用户群体及其特征]
- **次要用户**：[描述辅助用户群体]

### 关键使用场景

1. [场景1：描述用户在什么情况下使用]
2. [场景2：描述另一个重要使用场景]

## 4. 功能范围

### 本期范围（In Scope）

- [核心功能1]
- [核心功能2]
- [核心功能3]

### 不在范围（Out of Scope）

- [延后功能1]
- [延后功能2]

## 5. 用户故事

### STORY-001: [故事标题]

**作为** [角色]，**我想要** [能力]，**以便** [收益]

**高层验收标准：**

- [业务可读的验收条件1]
- [业务可读的验收条件2]
- [业务可读的验收条件3]

**优先级：** P1

### STORY-002: [故事标题]

**当** [情境]，**我想要** [动机]，**从而** [预期结果]

**高层验收标准：**

- [业务可读的验收条件1]
- [业务可读的验收条件2]

**优先级：** P2

[继续添加更多用户故事...]

## 6. 里程碑与发布计划

### 里程碑 1：MVP（最小可行产品）

- **目标日期**：[日期]
- **包含功能**：[STORY-001, STORY-002]
- **成功标准**：[可衡量的成功指标]

### 里程碑 2：功能完善

- **目标日期**：[日期]
- **包含功能**：[STORY-003, STORY-004]
- **成功标准**：[可衡量的成功指标]

## 7. 风险与权衡

### 关键风险

1. **风险**：[描述风险]
   - **影响**：[潜在影响]
   - **缓解措施**：[如何降低风险]

2. **风险**：[描述风险]
   - **影响**：[潜在影响]
   - **缓解措施**：[如何降低风险]

### 关键权衡

- **权衡1**：[选择A vs 选择B，以及为什么]
- **权衡2**：[成本 vs 收益的考量]

## 8. 成功指标

### 关键绩效指标（KPIs）

- [KPI 1：具体的可衡量指标]
- [KPI 2：用户满意度或使用率指标]
- [KPI 3：业务价值指标]

### 监控计划

- [如何追踪和衡量成功]
- [数据收集方法]

## 9. 附录

### 相关文档

- [链接到相关的市场调研]
- [链接到竞品分析]
- [链接到用户调研数据]

### 术语表

- **术语1**：[定义]
- **术语2**：[定义]
```

### 3. 与 requirements.md 的关系

PRD 生成后，应该：

1. 每个用户故事（STORY-xxx）都应该在 requirements.md 中派生出具体的 FR/NFR
2. PRD 的高层验收标准应该在 requirements.md 中细化为可测试的 EARS 格式需求
3. 在 requirements.md 中建立追踪矩阵，明确每个 FR/NFR 源自哪个 STORY

### 4. 更新元数据

更新 spec.json：

```json
{
  "phase": "prd-generated",
  "documents": {
    "prd": {
      "generated": true,
      "approved": false,
      "story_count": [统计生成的故事数量]
    }
  },
  "updated_at": "current_timestamp"
}
```

### 5. 用户交互流程

1. **初始生成**：基于功能描述生成初版 PRD
2. **故事优化**：与用户迭代优化用户故事，确保准确捕捉业务需求
3. **优先级调整**：根据用户反馈调整故事优先级
4. **范围确认**：明确本期范围和非范围
5. **验收标准细化**：确保高层验收标准清晰且可理解

### 6. 质量检查清单

生成的 PRD 应该满足：

- [ ] 所有用户故事都有唯一 ID（STORY-xxx）
- [ ] 每个故事都有清晰的角色、能力和收益
- [ ] 高层验收标准业务可读，不含技术术语
- [ ] 明确区分本期范围和非范围
- [ ] 包含可衡量的成功指标
- [ ] 风险和权衡都有对应的缓解措施

## 示例输出片段

```markdown
### STORY-001: 实时进度可见

**作为**读者，**我想要**在写作/评分进行时实时看到进度与阶段结果，**以便**及时决策是否等待或中止。

**高层验收标准：**

- 页面不刷新即可看到新的进度卡片
- 中断后刷新页面可恢复到最新进度视图
- 连接异常时有可理解的用户提示

**优先级：** P1
```

这个 Story 后续会在 requirements.md 中派生出：

- FR-001：SSE 推送功能需求
- NFR-003：延迟和并发性能需求
- FR-002：断线重连需求

保持 PRD 与 requirements 的**单向推导关系**，避免信息重复维护。
