# 多智能体网络小说自动写作系统 全栈架构文档

## Table of Contents

- [多智能体网络小说自动写作系统 全栈架构文档](#table-of-contents)
  - [Introduction](./introduction.md)
    - [启动模板或现有项目](./introduction.md#启动模板或现有项目)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [技术摘要](./high-level-architecture.md#技术摘要)
    - [平台与基础设施选择](./high-level-architecture.md#平台与基础设施选择)
    - [仓库结构](./high-level-architecture.md#仓库结构)
    - [High Level Architecture](./high-level-architecture.md#high-level-architecture)
    - [1. 组件交互与技术概览图 (Component Interaction & Tech Overview)](./high-level-architecture.md#1-组件交互与技术概览图-component-interaction-tech-overview)
    - [2. C4模型 - 容器图 (C4 Model - Container Diagram)](./high-level-architecture.md#2-c4模型-容器图-c4-model-container-diagram)
    - [3. 核心数据流图 (Core Data Flow Diagram - DFD)](./high-level-architecture.md#3-核心数据流图-core-data-flow-diagram-dfd)
    - [4. 概括性时序图 (Simplified Sequence Diagram)](./high-level-architecture.md#4-概括性时序图-simplified-sequence-diagram)
    - [架构模式](./high-level-architecture.md#架构模式)
  - [Tech Stack](./tech-stack.md)
    - [Tech Stack表](./tech-stack.md#tech-stack表)
  - [Data Models](./data-models.md)
    - [AgentActivity (活动日志) - PostgreSQL](./data-models.md#agentactivity-活动日志-postgresql)
    - [Novel (小说) - PostgreSQL & Neo4j Node :Novel](./data-models.md#novel-小说-postgresql-neo4j-node-novel)
    - [Chapter (章节) - PostgreSQL & Neo4j Node :Chapter](./data-models.md#chapter-章节-postgresql-neo4j-node-chapter)
    - [ChapterVersion (章节版本) - PostgreSQL](./data-models.md#chapterversion-章节版本-postgresql)
    - [GenesisSession (创世会话) - PostgreSQL](./data-models.md#genesissession-创世会话-postgresql)
    - [Character (角色) - PostgreSQL & Neo4j Node :Character](./data-models.md#character-角色-postgresql-neo4j-node-character)
    - [WorldviewEntry (世界观条目) - PostgreSQL & Neo4j Node :WorldviewEntry](./data-models.md#worldviewentry-世界观条目-postgresql-neo4j-node-worldviewentry)
    - [Review (评审) - PostgreSQL](./data-models.md#review-评审-postgresql)
    - [StoryArc (故事弧) - PostgreSQL & Neo4j Node :StoryArc](./data-models.md#storyarc-故事弧-postgresql-neo4j-node-storyarc)
    - [Neo4j 关系模型概念](./data-models.md#neo4j-关系模型概念)
  - [Components](./components.md)
    - [核心后台服务](./components.md#核心后台服务)
    - [AI智能体 (AI Agents)](./components.md#ai智能体-ai-agents)
    - [Components图 (概念性)](./components.md#components图-概念性)
  - [External APIs](./external-apis.md)
    - [1. 大型语言模型 (LLM) API](./external-apis.md#1-大型语言模型-llm-api)
  - [Event Naming Conventions](./event-naming-conventions.md)
    - [1. 命名公式与聚合根 (Naming Formula & Aggregate Root)](./event-naming-conventions.md#1-命名公式与聚合根-naming-formula-aggregate-root)
    - [2. 官方动词表 (Controlled Verb Vocabulary)](./event-naming-conventions.md#2-官方动词表-controlled-verb-vocabulary)
    - [3. 事件版本化策略 (Event Versioning Strategy)](./event-naming-conventions.md#3-事件版本化策略-event-versioning-strategy)
    - [4. 强制事件结构 (Mandatory Event Structure)](./event-naming-conventions.md#4-强制事件结构-mandatory-event-structure)
    - [5. 处理复合动作 (Handling Compound Actions)](./event-naming-conventions.md#5-处理复合动作-handling-compound-actions)
    - [6. 死信队列 (Dead-Letter Queue - DLQ)](./event-naming-conventions.md#6-死信队列-dead-letter-queue-dlq)
  - [Core Workflows](./core-workflows.md)
    - [1. 业务流程：创世流程 (Genesis Flow) - UI触发](./core-workflows.md#1-业务流程创世流程-genesis-flow-ui触发)
    - [2. 业务流程：章节生成 (Chapter Generation) - 标准路径](./core-workflows.md#2-业务流程章节生成-chapter-generation-标准路径)
    - [3. 技术实现：包含所有机制的权威时序图](./core-workflows.md#3-技术实现包含所有机制的权威时序图)
  - [REST API Spec](./rest-api-spec.md)
  - [Database Schema](./database-schema.md)
    - [PostgreSQL](./database-schema.md#postgresql)
      - [核心设计原则](./database-schema.md#核心设计原则)
      - [SQL 定义](./database-schema.md#sql-定义)
    - [Neo4j](./database-schema.md#neo4j)
    - [WorldviewEntry 的关系模型详解](./database-schema.md#worldviewentry-的关系模型详解)
      - [1. 结构性与层级关系 (Structural & Hierarchical)](./database-schema.md#1-结构性与层级关系-structural-hierarchical)
      - [2. 实体间交互关系 (Inter-Entity Interactions)](./database-schema.md#2-实体间交互关系-inter-entity-interactions)
      - [3. 与角色（Character）的交互关系](./database-schema.md#3-与角色character的交互关系)
      - [4. 与章节版本（ChapterVersion）的叙事关系](./database-schema.md#4-与章节版本chapterversion的叙事关系)
  - [Source Tree](./source-tree.md)
  - [Backend Architecture: Unified Structure](./backend-architecture-unified-structure.md)
    - [后端统一架构说明](./backend-architecture-unified-structure.md#后端统一架构说明)
    - [服务启动示例](./backend-architecture-unified-structure.md#服务启动示例)
  - [Infrastructure and Deployment](./infrastructure-and-deployment.md)
    - [基础设施即代码 (Infrastructure as Code - IaC)](./infrastructure-and-deployment.md#基础设施即代码-infrastructure-as-code-iac)
    - [部署策略](./infrastructure-and-deployment.md#部署策略)
    - [环境](./infrastructure-and-deployment.md#环境)
    - [环境提升流程](./infrastructure-and-deployment.md#环境提升流程)
    - [回滚策略](./infrastructure-and-deployment.md#回滚策略)
  - [Error Handling Strategy](./error-handling-strategy.md)
    - [总体方法](./error-handling-strategy.md#总体方法)
    - [日志标准](./error-handling-strategy.md#日志标准)
    - [错误处理模式](./error-handling-strategy.md#错误处理模式)
      - [External APIs错误 (特别是LLM API)](./error-handling-strategy.md#external-apis错误-特别是llm-api)
      - [业务逻辑错误](./error-handling-strategy.md#业务逻辑错误)
      - [数据一致性](./error-handling-strategy.md#数据一致性)
  - [Coding Standards](./coding-standards.md)
    - [核心标准](./coding-standards.md#核心标准)
    - [命名约定](./coding-standards.md#命名约定)
    - [关键规则 (AI智能体必须严格遵守)](./coding-standards.md#关键规则-ai智能体必须严格遵守)
    - [语言特定指南](./coding-standards.md#语言特定指南)
  - [Test Strategy and Standards](./test-strategy-and-standards.md)
    - [测试理念](./test-strategy-and-standards.md#测试理念)
    - [测试类型与组织](./test-strategy-and-standards.md#测试类型与组织)
      - [1. 单元测试 (Unit Tests)](./test-strategy-and-standards.md#1-单元测试-unit-tests)
      - [2. 集成测试 (Integration Tests)](./test-strategy-and-standards.md#2-集成测试-integration-tests)
      - [3. 端到端测试 (End-to-End Tests)](./test-strategy-and-standards.md#3-端到端测试-end-to-end-tests)
    - [测试数据管理](./test-strategy-and-standards.md#测试数据管理)
    - [持续测试](./test-strategy-and-standards.md#持续测试)
  - [Security](./security.md)
    - [输入验证](./security.md#输入验证)
    - [认证与授权 (Authentication & Authorization)](./security.md#认证与授权-authentication-authorization)
    - [密钥管理 (Secrets Management)](./security.md#密钥管理-secrets-management)
    - [API安全](./security.md#api安全)
    - [数据保护](./security.md#数据保护)
    - [依赖安全](./security.md#依赖安全)
    - [Security测试 (后MVP)](./security.md#security测试-后mvp)
